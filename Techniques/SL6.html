<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US"><head><title>SL6: Defining a UI Automation Peer for a Custom Silverlight Control | Techniques for WCAG 2.0
              </title><link rel="canonical" href="http://www.w3.org/TR/WCAG20-TECHS/SL6.html"/><link rel="stylesheet" type="text/css" href="http://www.w3.org/StyleSheets/TR/2016/W3C-WG-NOTE.css"/><link rel="stylesheet" type="text/css" href="additional.css"/><link rel="stylesheet" type="text/css" href="slicenav.css"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/></head><body class="slices toc-inline"><div id="masthead"><p class="logo"><a href="http://www.w3.org/"><img width="72" height="48" alt="W3C" src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C"/></a></p><p class="collectiontitle"><a href="./">Techniques for WCAG 2.0</a></p></div><div id="skipnav"><p class="skipnav"><a href="#maincontent">Skip to Content (Press Enter)</a></p></div><a name="top"> </a><!-- TOP NAVIGATION BAR --><ul id="navigation"><li><strong><a href="Overview.html#contents" title="Table of Contents">Contents</a></strong></li><li><strong><a href="intro.html" title="Introduction to Techniques for WCAG 2.0"><abbr title="Introduction">Intro</abbr></a></strong></li><li><a title="SL5: Defining a Focusable Image Class for Silverlight" href="SL5.html"><strong>Previous: </strong>
        Technique SL5</a></li><li><a title="SL7: Designing a Focused Visual State for Custom Silverlight Controls" href="SL7.html"><strong>Next: </strong>
        Technique SL7</a></li></ul><div class="navtoc"><p>On this page:</p><ul id="navbar"><li><a href="#SL6-disclaimer">Important Information about Techniques</a></li><li><a href="#SL6-applicability">Applicability</a></li><li><a href="#SL6-description">Description</a></li><li><a href="#SL6-examples">Examples</a></li><li><a href="#SL6-resources">Resources</a></li><li><a href="#SL6-related-techs">Related Techniques</a></li><li><a href="#SL6-tests">Tests</a></li></ul></div><div class="skiptarget"><a id="maincontent">-</a></div> <h1><a name="SL6" id="SL6"> </a>SL6: Defining a UI Automation Peer for a Custom Silverlight Control</h1><div id="SL6-disclaimer"><h2>Important Information about Techniques</h2><p>See <a href="http://www.w3.org/TR/2016/NOTE-UNDERSTANDING-WCAG20-20160317/understanding-techniques.html">Understanding Techniques for WCAG Success Criteria</a> for important information about the usage of these informative techniques and how they relate to the normative WCAG 2.0 success criteria. The Applicability section explains the scope of the technique, and the presence of techniques for a specific technology does not imply that the technology can be used in all situations to create content that meets WCAG 2.0.</p></div><div class="applicability"><h2 id="SL6-applicability">Applicability</h2><div class="textbody"><ul><li><p> Microsoft Silverlight, versions 3 and greater </p></li><li><p> Silverlight managed programming model and Silverlight XAML </p></li></ul></div></div><p class="referenced">This technique relates to:</p><ul><li><a href="http://www.w3.org/TR/2008/REC-WCAG20-20081211/#ensure-compat-rsv">
				Success Criterion 4.1.2 (Name, Role, Value)</a><ul><li><a href="http://www.w3.org/WAI/WCAG20/quickref/20160105/#ensure-compat-rsv">
						How to Meet 4.1.2 (Name, Role, Value)
					</a></li><li><a href="http://www.w3.org/TR/2016/NOTE-UNDERSTANDING-WCAG20-20160317/ensure-compat-rsv.html">
						Understanding Success Criterion 4.1.2 (Name, Role, Value)
					</a></li></ul></li></ul><div class="ua-issues"><h2 class="small-head" id="ua10.6.1"> User Agent and Assistive Technology Support Notes</h2><p>See <a href="/WAI/WCAG20/Techniques/ua-notes/silverlight#SL6">User Agent Support Notes for SL6</a>. Also see <a href="silverlight_notes.html">Silverlight Technology Notes</a>.</p></div><h2 id="SL6-description">Description</h2><div class="textbody"><p>The objective of this technique is to create an <code>AutomationPeer</code> class
    				for a custom Silverlight control. The <code>AutomationPeer</code> exposes
    				accessibility properties of the control in a way that abstracts the
    				Silverlight technology specifics of the control model and maps information
    				to UI Automation concepts, so that these properties can be consumed
    				by the UI Automation accessibility framework. </p><p>The AutomationPeer concept is part of the overall architecture design
    				of the UI Automation system. The peer represents a deliberate abstraction
    				of the control, such that a client can obtain pattern-based information
    				about the specific purpose and capability of a control without knowing
    				its implementation-specific object model or having to resort to using
    				a framework-specific object model API. Also, the peers run in a different
    				process than the controls they represent, which has performance and
    				security advantages. For more information on UI Automation architecture,
    				see <a href="https://msdn.microsoft.com/en-us/library/ms747327.aspx">UI
    					Automation Overview on MSDN</a>. </p><p>Creating a custom Silverlight control is one way that Silverlight
    				application authors can create user interface components either for
    				their own application, or as a packaged redistributable that provides
    				the control UI for third parties. Creating an automation peer for a
    				custom control reports control-specific information to the UI Automation
    				accessibility framework, and enables a custom control to participate
    				in all of the same techniques involving UI Automation that can be used
    				for a control that is distributed in the core Silverlight run time.
    				Assistive technologies can use the UI Automation accessibility framework
    				to discover the name and role of the user interface component, and
    				can get and set values by accessing UI Automation patterns. UI Automation
    				thus supports extensibility, while maintaining a discovery system for
    				names, roles and values of UI components. </p><p>Control authors associate a peer with a class by implementing a method
    				override for the class implementation. Control authors declare name
    				and role through properties that are general to any UI Automation peer.
    				Control authors expose the means to get and set values by choosing
    				to support one or more patterns that are usually associated with a
    				role. For example, a control in the role of "Button" would
    				typically support an "Invoke" pattern. A consumer of UI Automation
    				could check whether the pattern was supported and then call the pattern-based
    				method <code>Invoke</code>, which would activate the button without
    				any device input events being produced or required. </p><p>By convention, controls and their automation peers share a naming
    				pattern. For example, if a control is named <code>Spinner</code>, its automation
    				peer is named <code>SpinnerPeer</code>. However, the actual wiring for the class-peer
    				association is made in the control code by overriding <code>OnCreateAutomationPeer</code>.
    				Thus it is necessary to have access to the control code in order to
    				associate a new peer class implementation with that control. </p><p>In addition to properties, automation peers can also expose methods
    				as part of the implemented UI Automation control pattern. For example,
    				a peer implementing the Value pattern can provide an implementation
    				of the <code>SetValue</code> method. The <code>SetValue</code> method
    				can be called by a UI Automation client in order to programmatically
    				set the value of the owner control. The functionality exposed by the
    				implementation of a control pattern can be accessed either by automation-based
    				testing, or by assistive technologies. </p></div><h2 class="small-head" id="SL6-examples">Examples</h2><h3 class="small-head" id="SL6-ex1">Example 1: SimpleNumericUpDown control and its peer</h3><div class="example"><div class="textbody"><p>The example implements a very simple Silverlight custom control named
    						SimpleNumericUpDown. The control is a templateable control, meaning
    						that the UI is defined in a XAML file that serves as the default UI,
    						but any consumer of the control can change the visual appearance by
    						applying a new template. Nevertheless, the basic accessibility characteristics
    						of the control can be shaped by the control author, and can apply even
    						for cases where the visible UI is noticably different. This separation
    						between design-implementation and code-behavior is one reason for the
    						peer-owner design in UI Automation. The majority of the example shows
    						the C# code, including the followingÂ : </p><ul><li><p> Associating the peer with the class. </p></li><li><p> Defining the peer, and basic information such as the class name. </p></li><li><p> Reporting which patterns the peer supports. In this case the peer
    						supports a Value pattern. </p></li></ul><p>Control definition class: </p><div class="code"><pre><code>   public class SimpleNumericUpDown : Control
   {
       public SimpleNumericUpDown()
       {
           this.DefaultStyleKey = typeof(SimpleNumericUpDown);
       protected override System.Windows.Automation.Peers.AutomationPeer OnCreateAutomationPeer()
       {
           return new SimpleNumericUpDownAutomationPeer(this);
       }
 // templating and event handlers omitted
       public static DependencyProperty NumericValueProperty = DependencyProperty.Register(
           "NumericValue",
           typeof(Int32),
           typeof(SimpleNumericUpDown),
           new PropertyMetadata(0)
           );
       public Int32 NumericValue
       {
           get { return (Int32)this.GetValue(NumericValueProperty); }
           set {this.SetValue(NumericValueProperty,value);}
       }
   }
   </code></pre></div><p>Automation peer definition: </p><div class="code"><pre><code>   public class SimpleNumericUpDownAutomationPeer : FrameworkElementAutomationPeer, IValueProvider
   {
       private SimpleNumericUpDown OwnerControl { get { return (SimpleNumericUpDown)Owner; } }
       public SimpleNumericUpDownAutomationPeer(SimpleNumericUpDown owner)
           : base(owner) {}
       //peer overrides
       protected override string GetClassNameCore()
       {
           return "SimpleNumericUpDown";
       }
       protected override AutomationControlType GetAutomationControlTypeCore()
       {
           return AutomationControlType.Spinner;
       }
       public override object GetPattern(PatternInterface patternInterface) {
           if (patternInterface == PatternInterface.Value)
           {
               return this;
           }
           return base.GetPattern(patternInterface);
       }
       // Value pattern implementation
       String IValueProvider.Value
       {
           get { return OwnerControl.NumericValue.ToString(); }
       }
       bool IValueProvider.IsReadOnly {get{return false;}}
       void IValueProvider.SetValue(string value)
       {
           OwnerControl.NumericValue = Convert.ToInt32(value);
       }
</code></pre></div><p>This example is shown in operation in the <a href="/WAI/WCAG20/Techniques/working-examples/SL6/SimpleNumericUpDownTestPage.html" class="ex-ref">working example of Simple Numeric UpDown control</a>.</p></div></div><h2 id="SL6-resources">Resources</h2><div class="textbody"><p>Resources are for information purposes only, no endorsement implied.</p><ul><li><p>
                  <a href="https://msdn.microsoft.com/en-us/library/cc645045(VS.95).aspx">UI
    						Automation of a Silverlight Custom Control</a> 
               </p></li><li><p>
                  <a href="https://msdn.microsoft.com/en-us/library/system.windows.automation.peers.frameworkelementautomationpeer%28VS.95%29.aspx">FrameworkElementAutomationPeer</a> 
               </p></li><li><p>
                  <a href="https://msdn.microsoft.com/en-us/library/ms753388.aspx">Accessibility</a> 
               </p></li><li><p>Tools: <a href="http://firstfloorsoftware.com/silverlightspy">SilverlightSpy</a> or <a href="http://uiautomationverify.codeplex.com/">UIAVerify</a> 
               </p></li></ul></div><h2 id="SL6-related-techs">Related Techniques</h2><div class="textbody"><ul><li><a href="G10.html">G10: Creating components using a technology that supports the accessibility
          API features of the platforms on which the user agents will be run to expose the
          names and roles, allow user-settable properties to be directly set, and provide
          notification of changes</a></li></ul></div><h2 id="SL6-tests">Tests</h2><div class="textbody"><h3 class="small-head" id="SL6-procedure">Procedure</h3><ol class="enumar"><li><p> Using a browser that supports Silverlight, open an HTML page that
    					references a Silverlight application through an object tag. To see
    					UI Automation, use Microsoft Windows as platform. </p></li><li><p> Use a verification tool that is capable of showing the full automation
    						tree, and an objectâs UI Automation properties and patterns as part
    						of the tree. (For example, use UIAVerify or Silverlight Spy; see
    						Resources links.) Select the item in the automation tree that is
    						accessing the relevant custom automation peer implementation. </p></li><li><p> Examine the set of properties exposed in the tree. Check that
    							name is reported by Name, that the class name is reported as ClassName,
    							and that there is a role as reported by the value of ControlType. </p></li><li><p> If the control is expected to report a value, check that the value
    								is reported in the tree somehow. (Exactly which property reports
    								the value varies depending on the control function and pattern; for
    								more information, see <a href="https://msdn.microsoft.com/en-us/library/ff486375%28VS.85%29.aspx">Windows
    									Automation API</a>). </p></li><li><p> Check whether a control pattern is reported in the tree. If a
    										control pattern is reported, test the methods of that pattern using
    										facilities in the verification tool. Verify that invoking the methods
    										has changed the corresponding read only property values in the tree. </p></li></ol><h3 class="small-head" id="SL6-results">Expected Results</h3><p>#3, #4, and #5 (if applicable) are true. </p><p>If this is a sufficient technique for a success criterion, failing this test procedure does not necessarily mean that the success criterion has not been satisfied in some other way, only that this technique has not been successfully implemented and can not be used to claim conformance.</p></div><!-- BOTTOM NAVIGATION BAR --><ul id="navigationbottom"><li><strong><a href="#top">Top</a></strong></li><li><strong><a href="Overview.html#contents" title="Table of Contents">Contents</a></strong></li><li><strong><a href="intro.html" title="Introduction to Techniques for WCAG 2.0"><abbr title="Introduction">Intro</abbr></a></strong></li><li><a title="SL5: Defining a Focusable Image Class for Silverlight" href="SL5.html"><strong>Previous: </strong>
        Technique SL5</a></li><li><a title="SL7: Designing a Focused Visual State for Custom Silverlight Controls" href="SL7.html"><strong>Next: </strong>
        Technique SL7</a></li></ul><div class="footer"><p class="copyright">This Web page is part of <a href="Overview.html">Techniques and Failures for Web Content Accessibility Guidelines 2.0</a> (see the <a href="http://www.w3.org/TR/WCAG20-TECHS/SL6.html">latest version of this document</a>). The entire document is also available as a <a href="complete.html">single HTML file</a>. See the <a href="http://www.w3.org/WAI/intro/wcag20">The WCAG 2.0 Documents</a> for an explanation of how this document fits in with other Web Content Accessibility Guidelines (WCAG) 2.0 documents. To send public comments, please follow the <a href="http://www.w3.org/WAI/WCAG20/comments/">Instructions for Commenting on WCAG 2.0 Documents</a>.
 </p><p class="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> Â© 2016 <a href="http://www.w3.org/"><acronym title="World Wide Web Consortium">W3C</acronym></a><sup>Â®</sup> (<a href="http://www.csail.mit.edu/"><acronym title="Massachusetts Institute of Technology">MIT</acronym></a>, <a href="http://www.ercim.eu/"><acronym title="European Research Consortium for Informatics and Mathematics">ERCIM</acronym></a>, <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply.</p></div></body></html>